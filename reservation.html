<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RÃ©servation - New Fiestas</title>

<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<!-- Ton CSS -->
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
    <h1>âœ¨ New Fiestas</h1>
    <nav>
        <a href="index.html">Accueil</a>
        <a href="galerie.html">Galerie</a>
        <a href="reservation.html">RÃ©server</a>
    </nav>
</header>

<main>

<section>
    <h2>ğŸ“… RÃ©server une date</h2>
    <div id="calendar"></div>
</section>

<section>
    <h2>Formulaire de rÃ©servation</h2>
    <form id="reservationForm">
        <input type="text" placeholder="Nom" required>
        <input type="email" placeholder="Email" required>
        <input type="date" id="dateInput" required>
        <input type="time" required>
        <input type="number" placeholder="Nombre de personnes" required>
        <button type="submit">RÃ©server</button>
    </form>
</section>

</main>

<footer>
    Â© 2026 New Fiestas
</footer>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBXunGz12bxeHIyIhsbQ12CGlVDP3E9ayc",
    authDomain: "newfestas-e6a0d.firebaseapp.com",
    projectId: "newfestas-e6a0d",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

document.addEventListener('DOMContentLoaded', async function () {

  const calendarEl = document.getElementById('calendar');

  // ğŸ”¥ RÃ©cupÃ©rer les rÃ©servations Firestore
  const querySnapshot = await getDocs(collection(db, "reservations"));

  let events = [];

  querySnapshot.forEach((doc) => {
    const data = doc.data();

    if (data.statut === "confirmÃ©e") {
      events.push({
        title: "RÃ©servÃ©",
        start: data.date,
        color: "#ff4d4d"
      });
    }
  });

  // ğŸ‰ Initialiser FullCalendar
  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    locale: 'fr',
    events: events,

    dateClick: function(info) {

        const dateClicked = info.dateStr;

        const isReserved = events.some(event => event.start === dateClicked);

        if (isReserved) {
            alert("Date dÃ©jÃ  rÃ©servÃ©e !");
        } else {
            alert("Date disponible !");
        }
    }

});

calendar.render();

});

</script>

</body>
</html>
